#! /usr/bin/env python
#  -*- coding: utf-8 -*-
#
# GUI module generated by PAGE version 6.0
#  in conjunction with Tcl version 8.6
#    Jan 06, 2021 07:32:20 PM +0200  platform: Windows NT

import sys
sys.path.append('..')
import pymongo

try:
    import Tkinter as tk
except ImportError:
    import tkinter as tk

try:
    import ttk
    py3 = False
except ImportError:
    import tkinter.ttk as ttk
    py3 = True

import MatirialPageTeacher_support
import Teachermainmenu
from data import getSubject, connect_to_db_and_collection
import ntpath
import base64
from tkinter import messagebox, filedialog
import MatirialPageTeacher

def vp_start_gui():
    '''Starting point when module is the main routine.'''
    global val, w, root
    root = tk.Tk()
    top = MatirialPageTeacher (root)
    MatirialPageTeacher_support.init(root, top)
    root.mainloop()

w = None
def create_MatirialPageTeacher(rt, *args, **kwargs):
    '''Starting point when module is imported by another module.
       Correct form of call: 'create_MatirialPageTeacher(root, *args, **kwargs)' .'''
    global w, w_win, root
    #rt = root
    root = rt
    w = tk.Toplevel (root)
    top = MatirialPageTeacher (w)
    MatirialPageTeacher_support.init(w, top, *args, **kwargs)
    return (w, top)

def destroy_MatirialPageTeacher():
    global w
    w.destroy()
    w = None

class MatirialPageTeacher:
    def Reset(self):
        self.FileNameMass.configure(text="")
        self.newfile = None

    def openmainmenu(self):
        root.destroy()
        Teachermainmenu.vp_start_gui()

    def chosefile(self):
        self.newfile = filedialog.askopenfile(initialdir='/', title="תבחר קובץ להעלאה", mode='rb',
                                              filetypes=[('PDF files', '*pdf'), ('RAR files', '*.rar'),
                                                         ('ZIP files', '*zip')])
        self.FileNameMass.configure(text=ntpath.basename(self.newfile.name))

    def uploadfile(self):
        if self.newfile ==None:
            messagebox.showwarning("העלאה לא חוקית","קובץ לא נבחר")
            return
        collection = connect_to_db_and_collection('EZSchooldb', f'{self.current_subject} Matirial')
        encoded_string = base64.b64encode(self.newfile.read())
        filename = ntpath.basename(self.newfile.name)
        data = {'file_name': filename, 'Matirial_file': encoded_string}
        collection.insert_one(data)
        self.Reset()
        messagebox.showinfo("הועלה בהצלחה", "הקובץ הועלה בהצלחה נא לעלות קובץ נוסף או לחזור לתפריט הראשי")

    def __init__(self, top=None):
        self.current_subject = getSubject()
        self.newfile = None
        '''This class configures and populates the toplevel window.
           top is the toplevel containing window.'''
        _bgcolor = '#d9d9d9'  # X11 color: 'gray85'
        _fgcolor = '#000000'  # X11 color: 'black'
        _compcolor = '#d9d9d9' # X11 color: 'gray85'
        _ana1color = '#d9d9d9' # X11 color: 'gray85'
        _ana2color = '#ececec' # Closest X11 color: 'gray92'

        top.geometry("600x450+602+216")
        top.minsize(120, 1)
        top.maxsize(1924, 1061)
        top.resizable(1,  1)
        top.title("דף חומרי לימוד")
        top.configure(background="#80ffff")

        self.titleL = tk.Label(top)
        self.titleL.place(relx=0.333, rely=0.044, height=51, width=184)
        self.titleL.configure(background="#0000ff")
        self.titleL.configure(disabledforeground="#a3a3a3")
        self.titleL.configure(font="-family {Segoe UI} -size 14 -weight bold -underline 1")
        self.titleL.configure(foreground="#000000")
        self.titleL.configure(relief="ridge")
        if self.current_subject == 'Math':
            self.titleL.configure(text='''חומרי לימוד בחשבון''')
        elif self.current_subject == 'History':
            self.titleL.configure(text='''חומרי לימוד בהיסטוריה''')
        elif self.current_subject == 'Hebrew':
            self.titleL.configure(text='''חומרי לימוד בעברית''')
        elif self.current_subject == 'Tanach':
            self.titleL.configure(text='''חומרי לימוד תנ"ך''')


        self.MainMenuBtn = tk.Button(top)
        self.MainMenuBtn.place(relx=0.033, rely=0.778, height=84, width=167)
        self.MainMenuBtn.configure(activebackground="#ececec")
        self.MainMenuBtn.configure(activeforeground="#000000")
        self.MainMenuBtn.configure(background="#ffffff")
        self.MainMenuBtn.configure(disabledforeground="#a3a3a3")
        self.MainMenuBtn.configure(font="-family {Segoe UI} -size 14 -weight bold")
        self.MainMenuBtn.configure(foreground="#000000")
        self.MainMenuBtn.configure(highlightbackground="#d9d9d9")
        self.MainMenuBtn.configure(highlightcolor="black")
        self.MainMenuBtn.configure(pady="0")
        self.MainMenuBtn.configure(text='''תפריט ראשי''')
        self.MainMenuBtn.configure(command=self.openmainmenu)

        self.ChosefileBtn = tk.Button(top)
        self.ChosefileBtn.place(relx=0.65, rely=0.333, height=84, width=147)
        self.ChosefileBtn.configure(activebackground="#ececec")
        self.ChosefileBtn.configure(activeforeground="#000000")
        self.ChosefileBtn.configure(background="#ff8040")
        self.ChosefileBtn.configure(disabledforeground="#a3a3a3")
        self.ChosefileBtn.configure(font="-family {Segoe UI} -size 12 -weight bold")
        self.ChosefileBtn.configure(foreground="#000000")
        self.ChosefileBtn.configure(highlightbackground="#d9d9d9")
        self.ChosefileBtn.configure(highlightcolor="black")
        self.ChosefileBtn.configure(pady="0")
        self.ChosefileBtn.configure(text='''בחר קובץ''')
        self.ChosefileBtn.configure(command=self.chosefile)

        self.InstL = tk.Label(top)
        self.InstL.place(relx=0.65, rely=0.2, height=31, width=144)
        self.InstL.configure(background="#00ff40")
        self.InstL.configure(disabledforeground="#a3a3a3")
        self.InstL.configure(font="-family {Segoe UI} -size 12 -weight bold")
        self.InstL.configure(foreground="#000000")
        self.InstL.configure(relief="ridge")
        self.InstL.configure(text='''להעלאת קובץ''')

        self.FileNameMass = tk.Message(top)
        self.FileNameMass.place(relx=0.317, rely=0.444, relheight=0.073
                , relwidth=0.25)
        self.FileNameMass.configure(background="#80ffff")
        self.FileNameMass.configure(cursor="fleur")
        self.FileNameMass.configure(foreground="#000000")
        self.FileNameMass.configure(highlightbackground="#d9d9d9")
        self.FileNameMass.configure(highlightcolor="black")
        self.FileNameMass.configure(relief="sunken")
        self.FileNameMass.configure(width=150)

        self.fileNameL = tk.Label(top)
        self.fileNameL.place(relx=0.317, rely=0.333, height=31, width=154)
        self.fileNameL.configure(background="#800080")
        self.fileNameL.configure(disabledforeground="#a3a3a3")
        self.fileNameL.configure(font="-family {Segoe UI} -size 12 -weight bold")
        self.fileNameL.configure(foreground="#000000")
        self.fileNameL.configure(relief="ridge")
        self.fileNameL.configure(text='''שם הקובץ''')

        self.UploadBtn = tk.Button(top)
        self.UploadBtn.place(relx=0.65, rely=0.622, height=74, width=147)
        self.UploadBtn.configure(activebackground="#ececec")
        self.UploadBtn.configure(activeforeground="#000000")
        self.UploadBtn.configure(background="#ff0000")
        self.UploadBtn.configure(disabledforeground="#a3a3a3")
        self.UploadBtn.configure(font="-family {Segoe UI} -size 12 -weight bold")
        self.UploadBtn.configure(foreground="#000000")
        self.UploadBtn.configure(highlightbackground="#d9d9d9")
        self.UploadBtn.configure(highlightcolor="black")
        self.UploadBtn.configure(pady="0")
        self.UploadBtn.configure(text='''להעלאת הקובץ''')
        self.UploadBtn.configure(command=self.uploadfile)

if __name__ == '__main__':
    vp_start_gui()





